# Pattern Composite

## Problème

* Il est nécessaire de représenter au sein d'un système des hiérarchies de composition.
* Les clients d'une composition doivent ignorer s'ils communiquent avec des objets composés ou non.

## Description

un objet composite est constitué d'un ou de plusieurs objets similaires (ayant des fonctionnalités similaires). L'idée est de manipuler un groupe d'objets de la même façon que s'il s'agissait d'un seul
objet. Les objets ainsi regroupés doivent posséder des opérations communes, c'est-à-dire un **dénominateur** commun.

# Structure

![Pattern Composite](pattern_composite.png)

Les classes misent en oeuvre sont :

* Objet : interface pour la composition d'objets ; met en ÷uvre le comportement par défaut
* ObjetSimple : représente les objets manipulés, ayant une interface commune
* ObjetComposite : dénit un comportement pour les composants ayant des enfants ; stocke les
composants enfants ; met en ÷uvre la gestion des composants enfants La classe utilisatrice manipule
les objets de la composition à travers l'interface Objet.

Exemple:

``` c++
#ifndef COMPOSITE_H
#define COMPOSITE_H

#include <string>
#include <vector>

//un fichier de base
class FichierAbstrait
{
        static const int m_taille;

        protected:
        std::string m_nom;

        public:
        virtual int GetTaille() const;
        virtual void Afficher() const ;

        virtual ~FichierAbstrait() =0;
        FichierAbstrait(const std::string& nom);
};

//un fichier terminal
class Fichier :public FichierAbstrait 
{
        private:
        std::string m_type;

        public:
        void Afficher() const ;
        Fichier(const std::string& nom,const std::string& type);
        ~Fichier();
};

//un conteneur
class Dossier : public FichierAbstrait
{
        private:
        std::vector<FichierAbstrait*> m_listfichier;

        public:

        void Afficher() const;
        int GetTaille() const;

        Dossier& Add(Dossier* file);

        void Add(Fichier* file);

        Dossier(const std::string& path);
        ~Dossier();

};

#endif

#include <iostream>
#include <string>
#include <iterator>

#include "composite.h"

using namespace std;

const int FichierAbstrait::m_taille=1;

FichierAbstrait::FichierAbstrait(const std::string& nom):
m_nom(nom)
{

}

int FichierAbstrait::GetTaille() const 
{
    return m_taille;
}

void FichierAbstrait::Afficher() const 
{
cout<<m_nom<<" "<<GetTaille();
}

FichierAbstrait::~FichierAbstrait() 
{

}

Fichier::Fichier(const string& nom,const string& type):
FichierAbstrait(nom),m_type(type)
{

}
void Fichier::Afficher() const 
{
    FichierAbstrait::Afficher();cout<<" "<<m_type<<endl;
}

Fichier::~Fichier()
{

}

Dossier::Dossier(const string& path):FichierAbstrait(path)
{

}

void Dossier::Afficher() const 
{
        //pour chaque élément du vecteur, on l'affiche
        vector<FichierAbstrait*>::const_iterator itb=m_listfichier.begin();
        const vector<FichierAbstrait*>::const_iterator ite=m_listfichier.end();

        cout<<"["<<m_nom<<"]";
        for(;itb!=ite;itb++)
        {
            (*itb)->Afficher();
        };
}

int Dossier::GetTaille() const
{
        //on fait la somme de la taille de chaque élément 
        int somtaille=0;
        
        vector<FichierAbstrait*>::const_iterator itb=m_listfichier.begin();
        const vector<FichierAbstrait*>::const_iterator ite=m_listfichier.end();

        for(;itb!=ite;itb++)
        {
        somtaille+=(*itb)->GetTaille();        
        }
        
        return somtaille;
}

Dossier::~Dossier()
{
        //on détruit chaque élément
        vector<FichierAbstrait*>::const_iterator itb=m_listfichier.begin();
        const vector<FichierAbstrait*>::const_iterator ite=m_listfichier.end();

        for(;itb!=ite;itb++)
        {
            delete (*itb) 
        };
}

Dossier& Dossier::Add(Dossier* file)
{
        m_listfichier.push_back(file);
        return (*file);        
}

void Dossier::Add(Fichier* file)
{
                m_listfichier.push_back(file);
}


int main(void)
{
        Dossier root("/");
        root.Add(new Dossier("home/")).Add(new Dossier("david/")).Add(new Fichier("composite.h","text"));

        root.Afficher();

}
```